The aim of Biomolecular Simulations: Methods and Protocols is to provide a comprehensive overview of recent advances in biomolecular simulations of proteins, small molecules, 
and nucleic acids. The main focus is on classical molecular dynamics (MD) simulations at atomistic and coarse-grained levels, with a few excursions at the quantum/ab initio 
level. The book is organized into four parts, each one covering the latest developments in a speciﬁc area.

The ﬁrst part of the book introduces the readers to the recent progresses in the development of accurate physico-chemical models of proteins, small molecules, nucleic acids, 
and lipids: the so-called force ﬁelds. This is a central topic in MD simulations, as their reliability strongly depends on the accuracy of the underlying force ﬁeld. 
Thankfully, force ﬁelds have shown signiﬁcant improvement over the past few years, especially in the case of disordered systems and nucleic acids.

The second part of the book is meant to give an overview of some of the most popular methods to accelerate MD and access time scales that would be prohibitive in conventional 
simulations. These methods are often referred to as enhanced sampling techniques. Special attention has been reserved to free-energy calculations and to the study of the 
interactions between small molecules and proteins, which are topics of extreme relevance in both academia and industry.

The third part of the book is focused on an area of research that has literally ﬂourished in the last decade, that of integrative or hybrid methods. Methods belonging to this 
class aim at improving the description of a system provided by the force ﬁeld by introducing additional sources of information, such as experimental, statistical, and 
bioinformatics data. Different approaches to determine more accurate structural models and conformational ensembles by integrating multiple sources of information into 
biomolecular simulations will be presented, including methods based on the maximum entropy principle and on Bayesian inference.

The fourth part of the book is dedicated to the analysis of the outcome of biomolecular simulations. This is a fervent area of research, since simulations typically produce an 
immense amount of data and extracting the most useful information from them is not always straightforward. These methods not only try to make sense of the large volume of data 
generated by MD, but they also enable effective comparisons between the outcomes of different simulations, thus facilitating reproducibility.

All the recent advances in the ﬁeld of biomolecular simulations presented in this book would be of limited use if researches could not readily access to the pieces of software 
that implement these methods. While this book does not extensively focus on this area (with a few exceptions), we strongly believe that the development and dissemination of 
(open source) software should be a fundamental part in the life of every computational researcher, and yet this effort is too often underappreciated.

Biomolecular Simulations: Methods and Protocols is intended as a practical guide for researchers in both academia and industry, ranging from novice to expert level. In the 
tradition of the Springer series Methods in Molecular Biology, each chapter ends with a “Notes” section. This part contains all those details, tips, and tricks of the trade as 
well as troubleshooting advice that usually do not ﬁnd place in standard research articles. We believe

that readers that are unfamiliar with biomolecular simulations will ﬁnd this section particularly useful to avoid those mistakes that are inevitably made when approaching a 
new ﬁeld of research. We also hope that more advanced users will enjoy the overview of the recent progresses in different areas of biomolecular simulations and possibly 
discover new tools that will prove useful for their current and future research projects.

We would like to conclude this Preface by thanking all the authors who devoted part of their time to contributing a chapter to the book and John Walker, Series Editor of 
Methods in Molecular Biology, who assisted us in reviewing chapters and assembling the book. Finally, a special thank goes to Daan Frankel, who honored us with a Foreword to 
this book and whose “Understanding Molecular Simulations” has been a precious guide for many of us who decided to adventure into the ﬁeld of biomolecular simulations.

Chapter 1

Atomistic Force Fields for Proteins

Robert B. Best

Abstract

All-atom, classical force ﬁelds for protein molecular dynamics (MD) simulations currently occupy a sweet spot in the universe of computational models, sufﬁciently detailed to 
be of predictive value in many cases, yet also simple enough that some biologically relevant time scales (microseconds or more) can now be sampled via specialized hardware or 
enhanced sampling methods. However, due to their long evolutionary history, there is now a myriad of force ﬁeld branches in current use, which can make it hard for those 
entering the simulation ﬁeld to know which would be the best set of parameters for a given application. In this chapter, I try to give an overview of the historical motivation 
for the different force ﬁelds available, suggestions for how to determine the most appropriate model and what to do if the results are in conﬂict with experimental evidence.

Key words Transferable model, CHARMM, AMBER, GROMOS, OPLS, Protein folding, Unfolded state, Conformational change, Membrane proteins

1

Introduction

Classical simulations of biomolecules have provided many insights into structure, function and dynamics. A spectrum of models ranging from extremely coarse-grained (one bead 
per residue or per molecule) to very detailed quantum mechanical methods has emerged for describing their dynamics and function, with a tradeoff to be made between accuracy and 
computational cost. Highly coarse-grained models, whilst computationally cheap, are usually only valid under speciﬁc conditions and may need to be reoptimized or parameterized 
for each problem they are applied to; they usually also result in unrealistically fast dynamics due to their smoother energy surface. At the other extreme, quantum mechanical 
models, while they can be very accurate, quickly become too slow to perform any sampling of time scales relevant to biology. All-atom simulations with explicit solvent, in 
which every atom, including hydrogen, is represented by an explicit particle, currently represent a reasonable trade-off between these two difﬁculties [1]. They are often 
referred to as “transferable”, meaning that their

parameters are reasonably independent of the molecule(s) in question; for example, they can be speciﬁed entirely from the sequence in the case of proteins. This gives them 
more predictive value than more coarse-grained models, and their reproduction of protein dynamical properties measured in experiment is frequently of useful accuracy. At the 
same time, partly thanks to Moore’s law [2], partly to the development of specialized hardware such as GPUs [3] and the ANTON supercomputer [4] and partly to advances in 
simulation algorithms and enhanced sampling methods [5, 6], it is now possible to run simulations with such models routinely reaching a microsecond (and sometimes millisecond) 
time scale. These time scales allow many biologically relevant processes to be accessed, from the folding of small proteins [7] to the functioning of ion channels [8].

In this chapter, I focus on classical non-polarizable (“additive”) force ﬁelds for running simulations of proteins (more detailed models are discussed in Chapter 4, and a less 
detailed, coarse-grained model in Chapter 5 of this book). I am only concerned with simulations in which the solvent molecules are explicitly included in the simulation, that 
is, implicit solvent models are not discussed. Since molecular simulations of proteins have the longest history amongst biomacromolecules, methods and force ﬁelds for proteins 
are perhaps the most developed. Most current empirical force ﬁelds share a very similar overall functional form due to their common heritage from the early days of molecular 
dynamics [9, 10]. As a result, users can very often choose independently the simulation code and force ﬁeld for a given application. The simulation package can easily be 
chosen according to performance, accuracy and desired features (e.g. enhanced sampling schemes)however, some care is needed (see Note 1).

The question of which force ﬁeld to use is more difﬁcult to answer. It is also probably the only question about force ﬁelds that most users would care to know about. 
Unfortunately, there is no simple answer, as all additive force ﬁelds available today have strengths and weaknesses. This is partly due to the limitations of the functional 
form which includes many effects only implicitly, such that any set of parameters is a coarse-graining and cannot be generally applicable; it is possible that more 
sophisticated models, including polarization or charge penetration effects, may ultimately be more accurate. However, due to the complexity of optimizing the large number of 
available parameters, there is surely still considerable room for improving parameters for current functional forms, and this challenge will be even more severe for more 
complex functional forms. Thus, we can anticipate that imperfect force ﬁelds will be with us for the foreseeable future. Users therefore cannot afford to treat force ﬁelds as 
a black box, but need to account for force ﬁeld limitations when designing a simulation study. This includes being aware of potential shortcomings,


running small tests relevant to the problem under consideration, comparison with experiment and possible reﬁnement of the results using experimental data. All of these are 
interconnected issues, and this chapter will attempt to provide some guidance on how to deal with them in real world applications.

2

Theory

2.1 Functional Form and Parameters

Classical atomistic force ﬁelds start by assigning each atom a speciﬁc chemical atom “type”, for example, aliphatic carbon or amide nitrogen. The potential energy of the 
system is then given by a form similar to that in Eq. 1:

V ¼V bonded þ Vnon‐bonded 

ð

1 Þ

where the bonded part of the energy function usually takes the form:

In this expression, the ﬁrst sum runs over pairs of bonded atoms with separation r i and equilibrium bond length r i 0 , the second sum runs over triples of bonded atoms with 
an angle between bonds of θ i and an equilibrium bond angle of θ 0 i and the last sum runs over sets of four consecutively bonded atoms with torsion angle ϕ i . The bond and 
angle terms are harmonic and the torsion angle term is given by the ﬁrst few terms of a Fourier series. The parameters ki , r i 0 and so on are deﬁned only in terms of the 
atom types rather than being atom speciﬁc; this constraint is what makes the scheme “transferable”, as well as reducing the number of parameters required. An “improper” 
torsion angle term with similar form to the torsion angles is often used to maintain tetrahedral or planar geometry. Some force ﬁelds use slight variations on this form, and 
additional terms.

The non-bonded part of the energy has the form:

" #


In which, the sums run over all atom pairs i, j (usually atoms separated by fewer than a 2–3 bonds are excluded from these terms) separated by a distance of r ij and having 
respective charges q i and qj . This type of non-polarizable energy function is often known as

“additive”, since it can be evaluated as a single sum, without the need to iterate a polarizable term to self-consistency. Force ﬁelds of this form originated with the 
“consistent force ﬁeld” developed by Lifson [9], together with Levitt and Warshel.

Clearly, the large number of parameters to be deﬁned requires careful optimization to give accurate results, such that determining these parameters is generally the province 
of specialists. Nonetheless, it is useful for users to understand the origin of the different terms and their interdependence. The bonds, angles and improper torsions are the 
stiffest terms in the force ﬁeld (i.e. the energy varies most for a given displacement from ideal geometry) and as such are relatively independent of the other terms. They can 
usually be determined based on small-molecule crystal structures, as well as geometry optimization and normal mode analysis using an accurate quantum chemistry method. 
Therefore, it is usually possible to deﬁne them at a relatively early stage of parameterization. The remaining bonded term “the torsion angles”, however, needs to be 
determined in the context of the rest of the force ﬁeld, as it tends to compensate for imperfections in the other terms and effects not capture by the rest of the force ﬁeld. 
It can also be determined by ﬁtting to quantum chemistry data; however, care is required for torsion angle parameters that are common to many residues in the protein, such as 
the backbone ϕ , ψ angles, as will be discussed later.

The Lennard-Jones parameters are usually determined by ﬁtting to experimental data on the physical and thermodynamic properties of simple liquids, an approach originally taken 
by the Optimized Potentials for Liquid Simulations (OPLS) developers [11]. The partial charges q i are perhaps one of the trickiest parameters to deﬁne. The most common method 
for doing so is to ﬁt them to reproduce the electrostatic potential obtained from a quantum mechanical calculation, a method pioneered by the Assisted Model Building with 
Energy Reﬁnement (AMBER) family of force ﬁelds [12]. However, the solutions are highly underdetermined in such a ﬁt so that strong regularization is required to deﬁne a 
unique solution (e.g. the solution in which all charges are as close to zero as possible), and the result depends on the speciﬁc regularization chosen. The result is also 
highly dependent on the molecular conformation chosen for the ﬁt and of course also on the level of quantum theory used. This uncertainty is reﬂected in the diversity of 
partial charges across different force ﬁelds. As will be seen later, this can be a critical factor in obtaining accurate protein-protein interactions.

2.2 Some Notes on Force Field Phylogeny and Parameterization Philosophy

The main all-atom force ﬁeld families are Chemistry at Harvard Molecular Mechanics (CHARMM), AMBER, Groningen Molecular Simulation (GROMOS) and OPLS/AA (the all-atom version 
of OPLS), most of which take their names from the simulation package with which they were originally associated, although most simulation codes now support more than one force 
ﬁeld family.

There is signiﬁcant overlap of methodology used for parameterization of these energy functions, so I will only describe the distinguishing features of each. I have also 
restricted discussion in this section to the main trunk of each force ﬁeld lineage, with a selection of branches and variations described in later application-speciﬁc 
contexts.

2.2.1 CHARMM

2.2.2 AMBER

The ﬁrst all-atom CHARMM protein force ﬁeld was CHARMM 22 [13], and this has been the basis for all subsequent atomistic, additive CHARMM protein force ﬁelds. One distinct 
feature of its parameterization was the use of QM energies for interaction of biomolecular fragments with water molecules in order to parameterize the partial charges qi . This 
was one of the ﬁrst parameterization procedures to attempt to mimic a condensed phase environment. The ﬁrst major update to the CHARMM 22 force ﬁeld was the addition of the 
“CMAP” potential in CHARMM 22/CMAP. This was a 2-dimensional (2D) cubic spline potential for the backbone ϕ , ψ torsion angles, which was better able to capture the features of 
the 2D distribution of ϕ , ψ angles observed in structures deposited in the protein data bank [14, 15]. The most recent update to CHARMM is version 36, in which the backbone 
CMAP was reﬁtted, and also the side-chain dihedral parameters were reoptimized against high-level QM data [16]. A further reﬁnement, CHARMM 36m, is described in more detail 
in a later section [17]. CHARMM 36 and 36m represent the state of the art for additive CHARMM force ﬁelds.

The ﬁrst all-atom AMBER force ﬁeld intended for explicit solvent simulations was AMBER ff94 [18], and this has served as the parent of most atomistic AMBER force ﬁelds till 
the present day. The novel feature introduced in the parameterization of this force ﬁeld was the ﬁtting of atomic partial charges to reproduce the electrostatic potential 
obtained from QM calculations using Hartree-Fock in the gas phase, known as restrained electrostatic potential (RESP) ﬁtting [12, 18]. Restraints, or regularization, are 
needed in order to remove the degeneracy from the solution space. This procedure is easily automated and provides a well-deﬁned, algorithmic procedure for deriving charges for 
new molecules. The use of HartreeFock for determining the electrostatic potential leads to a slight “overpolarization” which was justiﬁed as approximately mimicking a 
condensed phase environment would also tend to increase polarization. This set of partial charges has been used without modiﬁcation in almost all AMBER force ﬁelds to date. 
The main exception was the AMBER ff03 force ﬁeld which also used a RESP procedure to obtain charges, but the QM electrostatic potential was computed with an implicit solvent 
environment, in conjunction with a higher level of QM theory. Although less extensively used, this force ﬁeld has some advantages, as will be described later. More recently, 
the


ff14ipq force ﬁeld used a sophisticated self-consistent reﬁnement of parameters in which the electrostatic environment in the QM calculation was represented by surrounding 
water molecules whose conﬁgurations were obtained by simulation with the previous parameter iteration [19]. The trunk of AMBER force ﬁeld development has nonetheless 
consisted of revisions of ff94, including ff96 [20], ff99 [21] and ff99SB [22], all of which primarily reﬁned torsion angle parameters. The ff99SB force ﬁeld was the standard 
for many years, until the recent publication of the ff14SB force ﬁeld which further reﬁned backbone and side-chain torsion parameters against high-level QM calculations and 
experimental data for peptides [23] and is considered the state of the art amongst the “standard” AMBER force ﬁelds. In addition to the force ﬁelds mentioned earlier, there 
are a myriad variants of each of these ofﬁcial versions, which would be impossible to comprehensively summarize in the space available. Nonetheless, some of these represent 
signiﬁcant improvements for certain applications and are described in further detail in other sections later.

2.2.3 GROMOS

2.2.4 OPLS/AA

Strictly speaking, the GROMOS force ﬁelds are not all-atom, since the non-polar hydrogens are not explicitly represented, instead being accounted for by the Lennard-Jones 
parameters of the carbon center to which they are bonded (i.e. “united-atom” model). There are also some signiﬁcant differences in the functional form for both bond and angle 
terms, which will not be described here as they are mainly intended for computational efﬁciency. Non-bonded parameters (both Lennard-Jones and partial charges) are ﬁtted to 
reproduce thermodynamic properties of pure liquids, as well as solvation thermodynamics of amino acid analogs. The most recent versions of the force ﬁeld are GROMOS 53A5 and 
53A6 [24]; versions 54A7 and 54B7 build on these primarily by reﬁning torsion angle parameters [25].

As mentioned earlier, OPLS was the ﬁrst force ﬁeld family to ﬁt non-bonded parameters based on liquid state simulations. The original all-atom OPLS-AA force ﬁeld [26] 
borrowed torsional parameters from AMBER, which were subsequently reﬁtted against QM energies for dipeptides in OPLS-AA/L [27]. OPLS-AA/L is perhaps the most widely used 
all-atom version of OPLS; however, it has been subsequently updated, the most recent version being OPLS3 [28]. A particular focus of OPLS parameter development has been small 
molecule binding, with a view towards applications in drug design.

This summary of force ﬁeld families is of necessity restricted to the most essential information on recent generations of the most widely used force ﬁelds. Those desiring a 
more comprehensive historical overview are referred to a recent review [29].

Although this chapter is about protein force ﬁelds, it is also important to specify what the model is for environment, which in most cases is water and inorganic ions. Each of 
the abovementioned force ﬁelds were developed with a speciﬁc three-site water model in mind, that being TIP3P [30] for the AMBER and OPLS families, a modiﬁed TIP3P model for 
CHARMM [13] and the SPC [31] model for the GROMOS family. The modiﬁcation for CHARMM consists of adding a small Lennard-Jones term to the hydrogens (which have no 
Lennard-Jones potential in standard TIP3P). For the most part, this modiﬁcation makes relatively little difference, although it can slightly alter folding equilibrium [32].

One unifying feature of the standard water models for use with protein force ﬁelds is that they are known to be quite poor models for water itself, particularly considering 
recent progress that has been made towards developing better models [33–37]. In most force ﬁelds, the water model is included in the parameterization, making it harder to 
justify a simple substitution. However, since the AMBER non-bonded parameters did not explicitly consider a water model in their derivation, it is easier to motivate testing 
with alternative models. Using either the TIP4P-Ew [35] or TIP4P2005 [34] models (two relatively accurate four-site models) did yield improvements in the properties of small 
peptides [38, 39]. However, as we discuss further in the later sections, a simple substitution of the water model was insufﬁcient to reproduce properties of disordered 
proteins: it turns out that the major deﬁciency of these models is not their reproduction of pure water properties but that the protein-water dispersion interactions are too 
weak.

A quick word on ions: if using a low salt concentration (less than ~100 mM), default force ﬁeld parameters for ions are usually adequate. However, if high salt conditions are 
of interest, more care is needed, since older parameter sets can lead to rapid and spontaneous formation of ion pairs and even small salt crystals well below the experimental 
solubility limit. Several efforts in recent years have addressed this problem [40, 41]. Note that the improved ion parameter sets are not necessarily included as the default in 
all distributions!

3

Methods

3.1 Choosing a Force Field for a Given Application

As alluded to in the introduction, there is no panacea for choosing a good force ﬁeld for a particular problem. Given that almost all force ﬁeld parameter sets have some 
known limitations, an initial literature search for applications close to the problem of interest will be useful to eliminate force ﬁelds with known deﬁciencies relevant to 
that application. Such an application-speciﬁc choice of force ﬁeld may seem to go against the spirit of general-purpose transferable force ﬁelds that should be applicable to 
a broad range of problems.

However, given that force ﬁelds are not quite at this point yet, it really is important to choose a force ﬁeld which is expected to be most accurate for the domain of 
interest—if it is not accurate enough, it may not be practical to use experimental data to correct the obtained ensembles. Although there is no substitute for familiarity with 
the literature, I have summarized here some of the important issues with recent force ﬁelds, how they have been at least partially resolved and how they affect different 
classes of problems. This is roughly ordered from problems which are least sensitive to force ﬁeld choice, to those that are most sensitive.

3.1.1 Conformational Changes in Folded Proteins

3.1.2 Protein Folding

Native state ﬂuctuations and dynamics and conversions between different conformational states of folded proteins are amongst the oldest applications of biomolecular force 
ﬁelds. Most force ﬁelds have been extensively tested for such problems, and major shortcomings have been addressed. Therefore, most recent force ﬁelds should do a reasonable 
job in reproducing the properties of folded proteins. Recent force ﬁeld modiﬁcations that affect folded proteins have focused mainly only improvements to torsion angle 
potentials. Examples include the CHARMM CMAP potential to more accurately describe the protein backbone in CHARMM 22/CMAP [14, 15] and both backbone CMAP and side-chain 
torsions in CHARMM 36 [16]. In the AMBER family, the ILDN modiﬁcation improved the description of side-chain torsion angles of Isoleucine, Leucine, Aspartate and Asparagine 
residues [42] for the AMBER ff99SB force ﬁeld [22]; more recently, the AMBER ff14SB force ﬁeld has integrated backbone and side-chain improvements into the main trunk of 
AMBER force ﬁelds. Simulations of folded states are relatively tolerant to many force ﬁeld errors, since the ability of the protein to sample incorrect states is rather 
limited whilst it remains folded, and unfolding usually only occurs on relatively long-time scales. Nonetheless, users are encouraged to read recent articles which compare the 
performance of different force ﬁelds in reproducing experimental data (especially that from nuclear magnetic resonance (NMR) spectroscopy) for the folded state [43] in order 
to guide their choice.

Protein folding, starting from a disordered chain, clearly samples a much greater region of conformational space and as such is more sensitive to force ﬁeld errors. Early 
simulations of the folding of small mini-proteins, particularly by Pande and co-workers, chalked up some important successes by obtaining folding events in unbiased 
simulations, but also revealed that certain force ﬁelds at the time were more appropriate for certain kinds of proteins—that is, according to whether the protein consisted 
primarily of alphahelical or beta-sheet structure [44–46]. This deﬁciency was also evident in all-atom simulations of the all- β WW-domain by Schulten and co-workers, which 
populated only α-helical structures

[47, 48]. The key to resolving this problem was reﬁnement of backbone dihedral angles, since even small biases, less than kB T, in favour of helical or extended structure 
could add up to a large cumulative effect over the whole sequence. This issue was resolved by reﬁning force ﬁelds against NMR data for peptides in solution, particularly 
using NMR data for the helix-forming peptide Ac-(AAQAA)3 -NH 2 [49], leading to the force ﬁelds AMBER ff03∗ and AMBER ff99SB∗ [50], which could fold into both alpha and beta 
structures [51, 52]. Similar reﬁnements of backbone torsion angles were made in the CHARMM 22∗ force ﬁeld by the DE Shaw group in their landmark study folding ten different 
proteins by unbiased MD simulations [7, 53]. Recent force ﬁelds such as CHARMM 36 [16] and AMBER ff14SB [23] have included similar corrections to the backbone potential. A 
more detailed approach to reﬁning the backbone potential is to use a residue-speciﬁc torsion potential (versus the common backbone potentials described earlier). This idea 
has been implemented in the recent residue-speciﬁc force ﬁelds RSFF1 [54] and RSFF2 [55], in which the backbone torsion terms are speciﬁcally ﬁtted for each residue to data 
from coil regions in structures deposited in the protein databank. With the types of torsion angle corrections summarized earlier, most current force ﬁelds should be much more 
capable than earlier generations of folding proteins to their native states. The accuracy of different force ﬁelds for studying protein folding has recently been assessed 
[56]. Indeed, detailed analysis of folding mechanisms obtained in the folding simulations by the DE Shaw group showed that the folding pathways obtained were in excellent 
agreement with relevant experimental observables [57]. Despite this success, many force ﬁelds which are capable of folding proteins still contain important deﬁciencies in the 
properties of unfolded states, as will be discussed later.

3.1.3 Unfolded Proteins, Intrinsically Disordered Proteins and ProteinProtein Interactions

The torsion angle corrections described earlier would certainly be expected to improve the properties of denatured states in force ﬁelds, through reducing formation of 
incorrect secondary structures. While this is indeed the case, it was also observed that a major residual shortcoming in the representation of unfolded states was that they 
were much too compact [58]. Switching to more accurate water models, although an improvement, did not fully resolve the situation [39]. This compaction, essentially 
attributable to the water in simulations being an insufﬁciently good solvent, is related to a second force ﬁeld deﬁciency, namely that the association of folded proteins is 
much too tight. Even proteins which are known to only weakly associate would associate non-speciﬁcally with very high afﬁnity in simulations [59], presumably attributable to 
the protein force ﬁeld being overall too hydrophobic. A number of solutions have been proposed to this problem, falling either into

the category of speciﬁcally modifying protein-water interactions [60, 61] or of modifying the water model itself [62]. Both have the effect of strengthening the dispersion 
interactions from the Lennard-Jones potential between the protein and water, thus making water a better solvent for unfolded proteins and yielding much better properties for 
unfolded proteins.

An obvious question when strengthening protein-water interactions is whether this would destabilize folded states, since the solvent accessible surface area is larger for 
unfolded states. This problem would be even more acute for larger proteins, since unfolded state surface area scales with the number of residues, N, while the folded state 
surface area grows as N2/3 . A slight destabilization was indeed observed for all approaches which corrected the over-collapse problem [60–62]. It appears that adding back a 
term representing stronger backbone hydrogen bonding, ﬁrst proposed by Nerenberg et al. [60] and more extensively developed by Robustelli et al. [63], helps to correct this 
shortcoming and may be sufﬁcient to create a force ﬁeld that is truly equally applicable to folded and unfolded proteins.

An issue which has received less attention in the literature than the overall degree of collapse in unfolded proteins is the strength of salt bridges in simulations. This has 
been observed to be relevant in some long-time scale simulations of protein folding and seems to be mainly related to the choice of side-chain partial charges on the charged 
side-chains, particularly those of arginine, aspartate and glutamate [53, 64]. In general, it seems that such salt bridges may be too strong in many force ﬁelds. A manual 
adjustment of charges using experimental data for association of small-molecule analogues of these side chains was found to improve the strength of (i.e. weaken) salt bridges 
in the CHARMM 22∗ force ﬁeld [53], as was the charge set in AMBER ff15ipq [64, 65]. A recent study of the association of side-chain analogues from multiple force ﬁelds 
suggested that the overlying tight binding of oppositely charged residues may be common to most force ﬁelds, with the best performing model in that study being AMBER ff03 
[66]. In many applications where charged groups are rare, overly strong salt bridges may not be a serious issue, but for highly charged (e.g. DNA-binding proteins and their 
binding partners and some intrinsically disordered proteins), it would clearly be preferable to choose one of the force ﬁelds that has a lower propensity to overstabilize salt 
bridges.

3.1.4 Membrane Protein Folding and Association

Both experiments and simulations of membrane proteins are less developed than for soluble proteins owing to the difﬁculty of working with membranes in both contexts. In the 
simulation context, a chief difﬁculty is the very high viscosity of the membrane itself. Very accurate models of membranes have been developed through years of careful 
reﬁnement, in particular the CHARMM

36 membrane force ﬁeld [67]. Together with the high-quality CHARMM 36 protein force ﬁeld [16], this is expected to be a good combination for simulations of membrane proteins. 
However, an initial calculation of the dissociation constant of glycophorin A, a prototypical transmembrane helix dimer, using the CHARMM 36 protein and lipid force ﬁelds 
showed that it was unstable, versus the strong experimental evidence that it was stable [68] (a similar result was obtained with the AMBER Slipids [69, 70] and AMBER ff03w 
protein force ﬁeld [39]). A simple adjustment of protein-lipid interactions was sufﬁcient to remedy this issue [68], although its generality remains to be tested. For larger 
transmembrane proteins, their greater intrinsic stability and the slow dynamics in the membrane likely mean that this issue will not be relevant to currently accessible 
simulation time scales.

3.2 Running Pilot Force Field Tests for a New Application

3.3 Testing Simulation Results Against Experimental Data

Although the earlier discussion covers many commonly encountered applications, it is impossible to be comprehensive. Since it is now straightforward in many MD codes to set up 
the same system with different force ﬁelds, it can be very useful to devise simple tests that can be informative of force ﬁeld quality before embarking on a large-scale 
simulation project. Often the main project will consume a large fraction of a computing allocation on a supercomputer facility, and there may not be a chance to repeat it with 
different force ﬁelds. But if the results turn out to be of too low quality due to a poorly chosen force ﬁeld, that time was essentially wasted. The ideal test should be as 
relevant as possible to the ﬁnal problem. To take an example from my own work, if one is interested in the properties of unfolded proteins in chemical denaturants, a 
quantitative comparison to data for association of chemical denaturants with model peptides will provide initial feedback on which force ﬁelds are most accurate [71, 72]. Such 
well-designed test cases can also be used to tweak force ﬁeld parameters in case no available force ﬁeld is of sufﬁcient quality [36], as discussed later. Choosing a 
sufﬁciently good force ﬁeld at the outset is important, even if experimental data are being used in conjunction (see Subheading 3.4 below and Part III of this book). This is 
ﬁrstly because in a simulation with an experimental bias any properties not determined by the experiment will come from the force ﬁeld (although in reality most properties 
would be determined by a combination of the two). Secondly, if reweighting is done after the fact in order to better match experiment, this will require the simulation ensemble 
to be sufﬁciently similar to the true ensemble in order to be practically useful.

Clearly, the goal of using molecular simulations is not just to reproduce experimental observables but to obtain atomistic insights that would be much harder, if not 
impossible, to glean from experiment, as discussed in Part III of this book. Nonetheless, as with any model, it is important to assess its accuracy by

comparing the results with the available experimental data (and thus, if there is an option, one should choose to study a system for which experimental data are available, or 
are expected to become available). Note that before comparing with experimental data, it is essential to demonstrate (as best possible) that the sampling is adequate to compute 
reliable equilibrium average (see Note 2 below). If the simulation is not sampling from an equilibrium distribution, then any disagreement from experiment could contain 
contributions both from the force ﬁeld and from the insufﬁcient/ inaccurate sampling, which will be impossible to separate.

For simple equilibrium properties, a commonly used measure of agreement of observables computed from simulation x i,sim with experimental counterparts x i,expt is the reduced χ 
2 parameter,

X N x i , sim À x i , 1 2 ¼ i¼1 À expt Á2  χ N σ sim 2 ð x i Þ þ σ expt 2 ð x i Þ

where the σ sim 2 ð x i Þ and σ expt 2 ð x i Þ are respectively the variances of the N simulated and experimental observables. The choice of χ 2 is due to its close relation to 
the likelihood function for Gaussiandistributed errors and because it weights deviations from experiment according to the associated errors. The intuitive interpretation is 
that for good agreement with experiment, χ 2 % 1. It is important to choose experimental data related to the properties of interest of the protein. For example, comparing with 
NMR scalar couplings, which give local information on dihedral angles, it is not likely to be very informative about the overall degree of collapse of a protein; on the other 
hand, the translational diffusion coefﬁcient or small-angle X-ray scattering data would be more relevant to the degree of collapse.

With a well-chosen force ﬁeld, it is now often possible to get quantitative agreement with experimental properties, at least in the vicinity of 300 K. Thus, ideally, computing 
this deviation should only help to conﬁrm that the results are consistent with experiment.

3.4 Dealing with Deviations from Experiment

In the unfortunate situation that there remain signiﬁcant deviations from the experimental properties of interest, this complicates any inferences of structure or mechanism 
from the simulation, since clearly even the equilibrium ensemble differs from experiment. There are two routes to recover from this situation. The simplest is to reweight the 
simulation snapshots in order to match the available data (of course with appropriate restraints on the weights to prevent overﬁtting), an approach which is presented in the 
chapters in Part III. However, this approach can only work if the overlap of the simulation with the true ensemble is sufﬁciently good. If there is bad overlap, the only way 
to ﬁt the experimental data will be to choose very non-uniform weights in the reweighting, that is, only a few snapshots would receive non-negligible

weights, casting doubt on the reliability of any conclusions drawn [73, 74]. In that situation, the only option is to carry out a new simulation.

The most straightforward way of performing such a new simulation that will better match experiment is to incorporate the experimental data, or some subset of the experimental 
data, as restraints in ensemble-restrained simulations, as also described in Part III. Leaving out a fraction of the data can help to test for overﬁtting in the restrained 
simulations. A more ambitious approach than doing restrained simulations would be to systematically modify the force ﬁeld itself, which has the potential advantage of 
improving both the present as well as future simulation studies [36, 50, 75]. However, this will be more demanding both in terms of computational costs and potential technical 
pitfalls.

4

Notes

1. It should be noted that even for the same force ﬁeld, small differences will generally be obtained in results using different codes, mainly due to differences in the 
treatment of non-bonded cut-offs and long-range dispersion corrections; considerable care is needed in replicating these details for quantitative comparisons, since different 
codes use different approaches or parameters by default, and exactly replicating cut-offs and switching functions in different codes is challenging. In the long run, the 
introduction of lattice sum methods for Lennard-Jones terms should help to further reduce differences between force ﬁeld implementations in different codes, as well as 
including the important long-range contribution to the dispersion forces [76].

2. Importance of appropriate sampling. Before drawing any conclusions regarding force ﬁeld quality, it needs to be shown that the sampling is sufﬁcient that the results 
approximate an equilibrium distribution—commonly referred to as “convergence”. Most experimental data reﬂect equilibrium properties, and it is not possible to compare them 
with a simulation that is not also sampling an equilibrium distribution. Following trends in collective properties (e.g. radius of gyration or a suitable reaction coordinate) 
versus time can give some indication of whether a simulation has converged. However, this can still be misleading if there is a large energy barrier which the system has not 
crossed during the simulation (this is true even when enhanced sampling schemes are used). A much more stringent test of convergence, appropriate for either unbiased runs or 
enhanced sampling simulations, is to start two or more runs from very different initial conditions, ideally on either side of

the putative major free energy barrier (e.g. folded, unfolded for protein folding or bound, unbound for binding). Convergence is obtained when the results from these runs are 
consistent, that is, the same within statistical error (since all averages obtained from simulation have some associated error). Estimation of the errors from molecular 
simulations must also be done with care, in order to avoid underestimating the error due to data which are correlated in time. A standard technique for overcoming this issue is 
block error analysis [77]. If the sampling has not been shown to be sufﬁcient to achieve convergence, it is pointless to even begin a discussion about force ﬁeld quality. 
Part II of this book has information about different enhanced sampling methods which may be able to speed up the rate of sampling.


References

1. Karplus M, McCammon JA (2002) Molecular dynamics simulations of biomolecules. Nat Struct Biol 9(9):646–652

2. Moore GE (1965) Cramming more components into integrated circuits. Electronics 38

6. Valsson O, Tiwary P, Parrinello M (2016) Enhancing important ﬂuctuations: rare events and metadynamics from a conceptual viewpoint. Annu Rev Phys Chem 67:159–184

(8):114–117

7. Lindorff-Larsen K, Piana S, Dror RO, Shaw DE (2011) How fast-folding proteins fold. Science 334:517–520

3. Friedrichs MS, Eastman P, Vaiyanathan V, Houston M, Legrand S, Beberg AL, Ensign DL, Bruns CM, Pande VS (2009) Accelerating molecular dynamics simulations on graphics 
processing units. J Comput Chem 30

8. Noskov SY, Berneche S, Roux B (2004) Control of ion selectivity in potassium channels by electrostatic and dynamic properties of carbonyl ligands. Nature 431:830–834

(6):864–872

4. Shaw DE, Deneroff MM, Dror RO, Kuskin JS, Larson RH, Salmon JK, Young C, Batson B, Bowers KJ, Chao JC, Eastwood MP, Gagliardo J, Grossman JP, Ho CR, Ierardi DJ, Kolossvary 
I, Klepeis JL, Layman T, McLeavey C, Moraes MA, Mueller R, Priest EC, Shan YB, Spengler J, Theobald M, Towles B, Wang SC (2007) Anton, a specialpurpose machine for molecular 
dynamics simulation. In: Isca’07: 34th Annual International Symposium on Computer Architecture, Conference Proceedings. Conference Proceedings Annual International Symposium on 
Computer Architecture. Assoc Computing Machinery, New York, NY, pp 1–12

5. Zuckerman DM (2011) Equilibrium sampling in biomolecular simulations. Annu Rev Biophys 40:41–62

9. Lifson S (1968) Consistent force ﬁeld for calculations of conformations, vibrational spectra and enthalpies of cycloalkane and n-alkane molecules. J Chem Phys 49(11):5116

10. Gelin BR, Karplus M (1975) Sidechain torsional potentials and motion of amino acids in proteins: bovine pancreatic trypsin inhibitor. Proc Natl Acad Sci U S A 72:2002

11. Tirado-Rives J, Jorgensen WL (1988) The OPLS [Optimized Potentials for Liquid Simulations] potential functions for proteins, energy minimizations for crystals of cyclic 
peptides and crambin. J Am Chem Soc 110(6):1657–1666

12. Bayly CI, Cieplak P, Cornell W, Kollman PA (1993) A well-behaved electrostatic potential based method using charge restraints for deriving atomic charges: the RESP model. J 
Phys Chem 97:10269–10280

13. MacKerell AD Jr, Bashford D, Bellot M, Dunbrack JRL, Evanseck JD, Field MJ, Fischer S, Gao J, Guo H, Ha S, Joseph-McCarthy D, Kuchnir L, Kuczera K, Lau FTK, Mattos C, 
Michnick S, Ngo T, Nguyen DT, Prodhom B, Reiher WE, III RB, Schlenkrich M, Smith JC, Stote R, Straub J, Watanabe M, Kuczera J, Yin D, Karplus M (2000) All-atom empirical 
potential for molecular modeling and dynamics studies of proteins. J Phys Chem B 102

development of improved protein backbone parameters. Proteins 65:712–725

23. Maier JA, Martinez C, Kasavajhala K, Wickstrom L, Hauser KE, Simmerling C (2015) ff14SB: improving the accuracy of protein side chain and backbone parameters from ff99SB. J 
Chem Theor Comput 11:3696–3713

(18):3586–3616

14. MacKerell AD Jr, Feig M, Brooks CL (2004) Improved treatment of the protein backbone in empirical force ﬁelds. J Am Chem Soc 126:698–699

15. MacKerell AD Jr, Feig M, Brooks CL (2004) Extending the treatment of backbone energetics in protein force ﬁelds: limitations of gas-phase quantum mechanics in reproducing 
protein conformational distributions in molecular dynamics simulations. J Comput Chem 25:1400–1415

16. Best RB, Zhu X, Shim J, Lopes P, Mittal J, Feig M, MacKerell AD Jr (2012) Optimization of the additive CHARMM all-atom protein force ﬁeld targeting improved sampling of 
the backbone φ , ψ and side-chain χ 1 and χ 2 dihedral angles. J Chem Theor Comput 8:3257–3273

17. Huang J, Rauscher S, Nawrocki G, Rang T, Feig M, De Groot BL, Grubmu¨ller H, Mackerell AD (2016) CHARMM36m: an improved force ﬁeld for folded and intrinsically disordered 
proteins. Nat Methods 14:71–73

18. Cornell WD, Cieplak P, Bayly CI, Kollman PA (1993) Application of RESP charges to calculate conformational energies, hydrogen bond energies, and free energies of solvation. 
J Am Chem Soc 115:9620–9631

19. Cerutti DS, Swope WC, Rice JE, Case DA (2014) ff14ipq: a self-consistent force ﬁeld for condensed-phase simulations of proteins. J Chem Theor Comput 10:4515–4534

20. Kollman PA (1996) Advances and continuing challenges in achieving realistic and predictive simulations of the properties of organic and biological molecules. Acc Chem Res 
29

24. Oostenbrink C, Villa A, Mark AE, van Gunsteren WF (2004) A biomolecular force ﬁeld based on the free enthalpy of hydration and solvation: the GROMOS force-ﬁeld parameter 
sets 53A5 and 53A6. J Comput Chem 25:1656

25. Schmid N, Eichenberger AP, Choutko A, Riniker S, Winger M, Mark AE, Van Gunsteren WF (2011) Deﬁnition and testing of the GROMOS force-ﬁeld versions 54A7 and 54B7. Eur 
Biophys J 40:843–856

26. Jorgensen WL, Maxwell DS, Tirado-Rives J (1996) Development and testing of the OPLS all-atom force ﬁeld on conformational energetics and properties of organic liquids. J 
Am Chem Soc 118:11225–11236

27. Kaminski GA, Friesner RA, Tirado-Rives J, Jorgensen WL (2001) Evaluation and reparameterization of the OPLS-AA force ﬁeld for proteins via comparison with accurate quantum 
chemical calculations on peptides. J Phys Chem B 105(28):6474–6487

28. Harder E, Damm W, Maple J, Wu C, Reboul M, Xiang JY, Wang L, Lupyan D, Dahlgren MK, Knight JL, Kaus JW, Cerutti DS, Krilov G, Jorgensen WL, Abel R, Friesner RA (2015) 
OPLS3: a force ﬁeld providing broad coverage of drug-like small molecules and proteins. J Chem Theor Comput 12:281–296

29. Riniker S (2018) Fixed-charge atomistic force ﬁelds for molecular dynamics simulations in the condensed phase: an overview. J Chem Inf Model 58:565–578

30. Jorgensen WL, Chandrasekhar J, Madura JD (1983) Comparison of simple potential functions for simulating liquid water. J Chem Phys 79(2):926–935

(10):461–469

31. Hermans J, Berendsen HJC, Van Gunsteren WF, Postma JPM (1984) A consistent empirical potential for water-protein interactions. Biopolymers 23:1513–1518

21. Wang J, Cieplak P, Kollman PA (2000) How well does a restrained electrostatic potential (RESP) model perform in calculating conformational energies of organic and 
biological molecules? J Comput Chem 21

(12):1049–1074

32. Boonstra S, Onck PR, Van der Giessen E (2016) CHARMM TIP3P water model suppresses peptide folding by solvating the unfolded state. J Phys Chem B 120:3692–3698

22. Hornak V, Abel R, Okur A, Strockbine B, Roitberg A, Simmerling C (2006) Comparison of multiple AMBER force-ﬁelds and

33. Vega C, Abascal JLF, Conde MM, Aragones JL (2008) What ice can teach us about water interactions: a critical comparison of the

performance of different water models. Faraday Discuss 141:251–276

34. Abascal JLF, Vega C (2005) A general purpose model for the condensed phases of water: TIP4P/2005. J Chem Phys 123:234505

35. Horn HW, Swope WC, Pitera JW, Madura JD, Dick TJ, Hura GL, Head-Gordon T (2004) Development of an improved four-site water model for biomolecular simulations: TIP4PEw. J 
Chem Phys 120:9665

36. Wang L-P, Martinez TJ, Pande VS (2014) Building force ﬁelds: an automatic, systematic and reproducible approach. J Chem Theor Comput 5:1885–1891

37. Izadi S, Anandakrishnan R, Onufriev AV (2014) Building water models: a different approach. J Phys Chem Lett 5:3863–3871

38. Nerenberg PS, Head-Gordon T (2011) Optimizing protein-solvent force ﬁelds to reproduce intrinsic conformational preferences of model peptides. J Chem Theory Comp 
7:1220–1230

39. Best RB, Mittal J (2010) Protein simulations with an optimized water model: cooperative helix formation and temperature-induced unfolded state collapse. J Phys Chem B 
114:14916–14923

40. Luo Y, Roux B (2009) Simulations of osmotic pressure in concentrated aqueous salt solutions. J Phys Chem Lett 1:183–189

41. Joung IS, Cheatham TE (2008) Determination of alkali and halide monovalent ion parameters for use in explicitly solvated biomolecular simulations. J Phys Chem B 
112:9020–9041

42. Lindorff-Larsen K, Piana S, Palmo K, Maragakis P, Klepeis JL, Dror RO, Shaw DE (2010) Improved side-chain torsion potentials for the Amber ff99SB protein force ﬁeld. 
Proteins 78:1950–1958

43. Lindorff-Larsen K, Maragakis P, Piana S, Eastwood MP, Dror RO, Shaw DE (2012) Systematic validation of protein force ﬁelds against experimental data. PLoS One 7(2):e32131

44. Snow CD, Nguyen H, Pande VS, Gruebele M (2002) Absolute comparison of simulated and experimental protein-folding dynamics. Nature 420:102–106

45. Snow CD, Zagrovic B, Pande VS (2002) The trp cage: folding kinetics and unfolded state topology via molecular dynamics simulations. J Am Chem Soc 124:14548

46. Zagrovic B, Snow CD, Shirts MR, Pande VS (2002) Simulation of folding of a small alphahelical protein in atomistic detail using worldwide-distributed computing. J Mol Biol 
323:927

47. Freddolino PL, Park S, Roux B, Schulten K (2009) Force ﬁeld bias in protein folding simulations. Biophys J 96:3772–3780

48. Freddolino PL, Harrison CB, Liu Y, Schulten K (2010) Challenges in protein folding simulations. Nat Phys 6:751–758

49. Shalongo W, Dugad L, Stellwagen E (1994) Distribution of helicity within the model peptide Acetyl(AAQAA)3 amide. J Am Chem Soc 116:8288–8293

50. Best RB, Hummer G (2009) Optimized molecular dynamics force ﬁelds applied to the helix-coil transition of polypeptides. J Phys Chem B 113:9004–9015

51. Mittal J, Best RB (2010) Tackling force-ﬁeld bias in protein folding simulations: folding of villin HP35 and pin WW domains in explicit water. Biophys J 99:L26–L28

52. Best RB, Mittal J (2010) Balance between α and β structures in ab initio protein folding. J Phys Chem B 114:8790–8798

53. Piana S, Lindorff-Larsen K, Shaw DE (2011) How robust are protein folding simulations with respect to force ﬁeld parameterization. Biophys J 100:L47–L49

54. Jiang F, Zhou C-Y, Wu Y-D (2014) Residuespeciﬁc force ﬁeld based on the protein coil library. RSFF1: modiﬁcation of OPLS-AA/L. J Phys Chem B 118:6983–6998

55. Zhou C-Y, Jiang F, Wu Y-D (2015) Residuespeciﬁc force ﬁeld based on protein coil library. RSFF2: modiﬁcation of AMBER ff99SB. J Phys Chem B 119:1035–1047

56. Piana S, Klepeis JL, Shaw DE (2014) Assessing the accuracy of physical models used in proteinfolding simulations: quantitative evidence from long molecular dynamics 
simulations. Curr Opin Struct Biol 24:98–105

57. Best RB, Hummer G (2016) Microscopic interpretation of folding phi-values using the transition-path ensemble. Proc Natl Acad Sci U S A 113(12):3263–3268

58. Nettels D, Mu¨ller-Sp€ath S, Ku¨ster F, Hofmann H, Haenni D, Ru¨egger S, Reymond L, Hoffmann A, Kubelka J, Heinz B, Gast K, Best RB, Schuler B (2009) Single molecule 
spectroscopy of the temperature-induced collapse of unfolded proteins. Proc Natl Acad Sci U S A 106:20740–20745

59. Petrov D, Zagrovic B (2014) Are current atomistic forceﬁelds accurate enough to study proteins in crowded environments? PLoS Comput Biol 10(5):e1003638

60. Nerenberg PS, Jo B, Tripathy A, Head-Gordon T (2012) Optimizing solute-water van der

Waals interactions to reproduce solvation free energies. J Phys Chem B 116:4524–4534

61. Best RB, Zheng W, Mittal J (2014) Balanced protein-water interactions improve properties of disordered proteins and non-speciﬁc protein association. J Chem Theor Comput 
10:5113–5124

62. Piana S, Donchev AG, Robustelli P, Shaw DE (2015) Water dispersion interactions strongly inﬂuence simulated structural properties of disordered protein states. J Phys Chem 
B 119:5113–5123

63. Robustelli P, Piana S, Shaw DE (2018) Developing a molecular dynamics force ﬁeld for both folded and disordered protein states. Proc Natl Acad Sci U S A 
115(21):E4758–E4766

64. Ahmed MC, Papaleo E, Lindorff-Larsen K (2018) How well do force ﬁelds capture the strength of salt bridges in proteins? PeerJ 6: e4967

65. Debiec KT, Cerutti DS, Baker LR, Gronenborn AM, Case DA, Chong LT (2016) Further along the road less travelled: AMBER ff15ipq, an original protein force ﬁeld built on a 
self-consistent physical model. J Chem Theor Comput 12:3926–3947

66. Debiec KT (2014) Evaluating the strength of salt bridges: a comparison of current biomolecular force ﬁelds. J Phys Chem B 118:6561–6569

67. Klauda JB, Venable RM, Freites JA, O’Connor JW, Tobias DJ, Mondragon-Ramirez C, Vorobyov I, Mackerell AD, Pastor RW (2010) Update of the CHARMM all-atom additive force 
ﬁeld for lipids: validation on six lipid types. J Phys Chem B 114:7830–7843

68. Domanski J, Sansom MSP, Stansfeld P, Best RB (2018) Balancing force ﬁeld protein-lipid interactions to capture transmembrane helix-helix association. J Chem Theor Comput 
14:1706–1715

69. Jambeck JPM, Lyubartsev AP (2012) Derivation and systematic validation of a reﬁned all-atom force ﬁeld for phosphatidylcholine lipids. J Phys Chem B 116:3164–3179

70. Jambeck JPM, Lyubartsev AP (2012) An extension and further validation of an all-atomistic force ﬁeld for biological membranes. J Chem Theor Comput 8:2938–2948

71. Horinek D, Netz RR (2011) Can simulations quantitatively predict peptide transfer free energies to urea solutions? Thermodynamic concepts and force ﬁeld limitations. J 
Phys Chem A 115:6125–6136

72. Zheng W, Borgia A, Borgia MB, Schuler B, Best RB (2015) Empirical optimization of interactions between proteins and chemical denaturants in molecular simulations. J Chem 
Theor Comput 11:5543–5553

73. Hummer G, Ko¨ﬁnger J (2015) Bayesian ensemble reﬁnement by replica simulations and reweighting. J Chem Phys 143:243150

74. Rangan R, Bonomi M, Heller GT, Cesari A, Bussi G, Vendruscolo M (2018) Determination of structural ensembles of proteins: restraining vs reweighting. J Chem Theor Comput 
14:6632

75. Di Pierro M, Elber R (2013) Automated optimization of potential parameters. J Chem Theor Comput 9:3311–3320

76. Wennberg CL, Murtola T, Pall S, Abraham MJ, Hess B, Lindahl E (2015) Direct-space corrections enable fast and accurate LorentzÀBerthelot combination rule LennardJones 
lattice summation. J Chem Theor Comput 11:5737–5746

77. Flyvbjerg H, Petersen HG (1989) Error estimates on averages of correlated data. J Chem Phys 91:461–466


